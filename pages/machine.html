
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MACHInE</title>

    <!-- fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Darker+Grotesque:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- style sheets -->
    <link href="../styles/all_pages.css" rel="stylesheet">
    <link href="../styles/table_of_contents.css" rel="stylesheet">
    <link href="../styles/machine.css" rel="stylesheet">
    <link href="../styles/animations.css" rel="stylesheet">
    <link href="../styles/custom_scrollbar.css" rel="stylesheet">
    <link href="../styles/fade_load.css" rel="stylesheet">
    <link href="../styles/navigation_bar.css" rel="stylesheet">

    <!-- scripts -->
    <script src="../scripts/table_of_contents.js"></script>
</head>
<body onload="document.body.style.opacity='1'">

    <div class="left"></div>
    <div class="right"></div>

    <!-- home bar -->
    <nav class="navigation_container">
        <!-- home bar -->
        <a class="home_link" href="../index.html">
            <img class="home_buttom_image" src="../images/home_button_image.svg" alt="home_button_image">
        </a>
        <div class="pages_container">
            <a class="navigation_link" href="./machine.html">MACHInE</a>
            <a class="navigation_link" href="./opcas.html">OP-CAS</a>
            <a class="navigation_link" href="./team.html">TEAM</a>
            <a class="navigation_link" href="./contact.html">CONTACT</a>
        </div>
    </nav>

    <!-- table of contents -->
    <!-- credit: https://codepen.io/pubwriter/pen/ZgLzYV -->
    <nav class="table_of_contents">
        <ul>
            <li><a href="#introduction" tabindex="1">Introduction</a></li>
            <li><a href="#getting_started">Getting Started</a></li>
            <li><a href="#bill_of_materials">Bill of Materials</a></li>
                <ul>
                    <li><a href="#vehicle_components">Vehicle Components</a></li>
                    <li><a href="#racing_circuits_components">Racing Circuit Components</a></li>
                    <li><a href="#tool_diagram_components">Tool Diagram Components</a></li>
                </ul>
            <li><a href="#hardware_assembly">Hardware Assembly</a></li>
                <ul>
                    <li><a href="#electrical_wiring_diagram">Electrical Wiring Diagram</a></li>
                </ul>
            <li><a href="#behaviorial_conditioning_algorithm">Behavioral Conditioning Algorithm</a></li>
            <li><a href="#github">Github Code</a></li>
            <li><a href="#outcome">Outcome</a></li>
        </ul>
        <!-- this doesn't work -->
        <svg class="table_of_contents_marker" width="200" height="200" xmlns="http://www.w3.org/2000/svg">
            <path stroke="#fff" stroke-width="3" fill="transparent" stroke-dasharray="0, 0, 0, 1000" stroke-linecap="round" stroke-linejoin="round" transform="translate(-0.5, -0.5)" />
        </svg>
    </nav>

    <article class="content">
        <section class="gap" style="height: 155px">
        </section>

        <section>
            <div class="title_wrapper">
                <h2 class="machine_title">Multi-Agent Autonomous Cars for High-Speed, Indoor Environments</h2>
                <img class="machine_image" src="../images/machine_cover.gif" alt="machine_cover">
            </div>
        </section>
        
        <section class="gap" style="height: 155px">
        </section>


        <h2 id="introduction">Introduction</h2>
        <section class="body">
            <p>One of the most pressing challenges within autonomous mobility lies within highway scenarios: where autonomous vehicles would be interacting with human drivers at high speeds. These scenarios are indeed challenging because autonomous vehicles require data driven methods to identify the intent of opposing vehicles while also simultaneously planning its trajectory. Although full-scale and high-speed testbeds exist (i.e. Roborace), the space and cost requirements are highly demanding. For this reason, we created an <b class="bold">open-source</b>, 1:28 scale research platform for high-speed autonomous driving research that is <b class="bold">accessible to everyone.</b></p>
        </section>

        <section class="gap">
        </section>
        <hr width="95%">
        <section class="gap">
        </section>

        <h2 id="getting_started">Getting Started</h2>
        <section class="body">
            <p>Building a scaled-down autonomous vehicle is quite a complex task. Please keep in mind of the following considerations:</p>

            <div class="sub_note">
                <!-- budget -->
                <h3>Budget</h3>
                <p>Although the material cost of building a vehicle is <b class="bold">less than $700</b>, several tools are needed:</p>
                <ul>
                    <li>basic electronic tools (i.e. screwdriver, soldering tool, glue gun)</li>
                    <li>a computer with a GPU (alternative: cloud computing)</li>
                    <li>3D printer</li>
                </ul>
                <p>Thus, the real cost of having a fully-functioning vehicle can fluctuate (depending on which tools are readily accessible or not). Please keep this in mind before jumping immediately into the project.</p>

                <!-- knowledge -->
                <h3>Knowledge</h3>
                <p>We provide two ways a vehicle can race itself autonomously. These methods and their resources are articulated below:</p>
                <ul>
                    <li>Deep Learning: we recommend viewing <a class="bold" href="https://youtu.be/PySo_6S4ZAg">university lectures</a> with topics concerning Deep Learning through YouTube</li>
                    <li>Sensor Fusion / Probabilistic Robotic Method: we recommend the <a class="bold" href="https://www.amazon.com/Probabilistic-Robotics-INTELLIGENT-ROBOTICS-AUTONOMOUS/dp/0262201623">Probabilistic Robotics (Intelligent Robotics and Autonomous Agents series) 1st Edition</a> book by Sebastian Thrun</li>
                </ul>

                <!-- electroncis -->
                <h3>Electronics</h3>
                <p>You should be able to understand how to use the following as well:</p>
                <ul>
                    <li>Raspberry Pi with General Purpose Input Output (GPIO) ports</li>
                    <li>hardware pulse width modulation (PWM) signaling and UART protocols</li>
                    <li>solder wires and understand how remote controlled cars work</li>
                    <li>the basics of First-Person-View (FPV) equipment (if you plan on driving your car with a FPV remote steering wheel setup)</li>
                </ul>

                <!-- 3d printing -->
                <h3>3D Printing</h3>
                <p>It is necessary to have access to a 3D printer. because the parts are (at most) palm-sized, 3D printers around less than 100 USD (such as the Sondori Pico 3D printer) will be enough. We also recommend the Prusa Mini+ or MK3S+ with +0.02mm tolerance PETG filament if you are serious about getting quality prints. Knowing how to use Computer Aided Design (CAD) is also necessary, provided that you are interested in making modifications to your vehicle in the future</p>

                <!--Programming -->
                <h3>Programming</h3>
                <p>Most of the code that we use is <b class="bold">Python</b>. You also need to know how to code within Deep Learning language frameworks. Although the project had began with Keras for Deep Learning, TensorFlow was later used. Alternatives include Pytorch (which has potential merit considering its developments in the area of deployment)</p>
            </div>
        </section>

        <section class="gap">
        </section>
        <hr width="95%">
        <section class="gap">
        </section>

        <h2 id="bill_of_materials">Bill of Materials</h2>
        <section class="body">
            <p>Several materials are needed for MACHiNE. Note that the cost of components does not reflect shipping cost. In addition, there are a total of three ways of controlling the vehicle for data collection. The <b class="bold">recommended method</b> is the low latency option â€“ as this offers the quickest communication protocols.</p>

            <div class="sub_note">                
                <!-- vehicle components -->
                <h2 id="vehicle_components">Autonomous Vehicle Components</h2>
                <img src="../images/bill_of_materials.jpg" stc="bill_of_materials" style="height: auto; width: 50%">
                <div class="row">
                    <div class="col">
                        <p>Compute Unit</p>
                        <ul>
                            <li>Raspberry Pi 4B 4G (9)</li>
                            <li>Samsung Evo Plus 256G SD Card</li>
                            <li>Risun RFB2008H 5v Blower Fan</li>
                            <li>OSKJ 5V-3A DC Step-Down Buck Converter</li>
                        </ul>
                    </div>

                    <div class="col">
                        <p>Chassis</p>
                        <ul>
                            <li>Kyosho Mini-Z MR-03 1:28 RTR Kit</li>
                            <li>PN Racing 2.5W Chassis Conversion Kit</li>
                            <li>PN Racing v3 Micro Servo Kit</li>
                            <li>OSKJ 5V-3A DC Step-Down Buck Converter</li>
                        </ul>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <p>Sensors</p>
                        <ul>
                            <li>US 1881 Latch Type Hall Sensor [x4]</li>
                            <li>Neodymium Magnet [x16]</li>
                            <li>Digital Battery Voltage Meter</li>
                            <li>Battery Current Meter</li>
                        </ul>
                    </div>

                    <div class="col">
                        <p>3D-Printed Parts</p>
                        <ul>
                            <li>Camera Mount</li>
                            <li>RPi Board Mount</li>
                            <li>Wheel Encoder Ring [x4]</li>
                            <li>Rear Mount T-Plate</li>
                            <li>Mount Standoffs</li>
                        </ul>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <p>Batteries & Shell</p>
                        <ul>
                            <li>Vapecell 3.7v 1S 350mAh Li-Ion Battery [x4] (8)</li>
                            <li>Mini-Z Truck Lexan Body Shell</li>
                            <li>Tamiya PS Spray Paint</li>
                        </ul>
                    </div>
                </div>

                <section class="gap">
                </section>

                <!-- racing circuit components -->
                <h2 id="racing_circuits_components">Racing Circuits Components</h2>
                <img src="../images/racing_circuit_diagram.png" stc="racing_circuit_diagram" style="height: auto; width: 50%">
                <div class="row">
                    <div class="col">
                        <p>First-Person-View</p>
                        <ul>
                            <li>Fatshark Scout FPV Goggles</li>
                            <li>TBS Nano Pro32 Video FPV Rx (27)</li>
                            <li>RunCam Eagle 3 FPV Camera (26)</li>
                        </ul>

                        <p>Other</p>
                        <ul>
                            <li>Orange Lap RC 4ch. PWM2USB Dongle (23)</li>
                        </ul>
                    </div>

                    <div class="col">
                        <p>Controller</p>
                        <ul>
                            <li>(Driving Mode Option) Thrustmaster 500RS / 300RS Gaming Wheel</li>
                            <li>(Budget Option) Logitech F710 Gaming Pad Controller</li>
                            <li>(Low Latency Option) Sanwa M17 RC Controller + RX 493 Receiver</li>
                            <li>Futaba T6J 6Ch. 2.4Ghz Tx Controller with Trainer Mode</li>
                            <li>Compufly v2.0 PPM2USB Futaba Ver.</li>
                        </ul>
                    </div>
                </div>

                <section class="gap">
                </section>

                <!-- tool diagram -->
                <h2 id="tool_diagram_components">Tool Diagram Components</h2>
                <img src="../images/tools.png" style="height: 75%; width: auto;">
                <div class="row">
                    <div class="col">
                        <p>Measurement Tools</p>
                        <ul>
                            <li>Tamiya Speed Checker</li>
                            <li>SkyRC Corner Weight Scale</li>
                            <li>ARR Aurora Car Setup System</li>
                        </ul>
                    </div>

                    <div class="col">
                        <p>Global Tracker</p>
                        <ul>
                            <li>Logitech Brio 4k Web Camera</li>
                            <li>Theia Wide Angle CS Lens</li>
                            <li>Kurokesu Brio CS Mount Kit</li>
                            <li>USB 3.0 20ft. Extension Cable</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section class="gap">
        </section>
        <hr width="95%">
        <section class="gap">
        </section>

        <h2 id="hardware_assembly">Hardware Assembly</h2>
        <section>
            <p>We made piecing together all the components more convenient with this instructional video.</p>
            <iframe width="560" height="315" src="https://www.youtube.com/embed/U2yloLSmdBk" title="MACHInE Instructional Build Video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </section>

        <section id="electrical_wiring_diagram">
            <h2>Electrical Wiring Diagram</h2>
            <div class="row">
                <div class="col">
                    <img src="../images/wiring.png" alt="wiring" style="height: auto; width: 75%;">
                </div>

                <div class="col">
                    <p>To the left is the wiring diagram to wire the vehicle electronics components. To avoid inhaling soldering fumes, it is <b class="bold">highly recommended</b> that a mini desk fan is bought. It is also recommend to buy multiple soldering tips (considering the fact that they wear out). Lastly, it is recommend that soldering paste is used (however, make sure to minimize the amount of paste to prevent the wires from shorting)</p>
                </div>
            </div>
        </section>

        <section class="gap">
        </section>
        <hr width="95%">
        <section class="gap">
        </section>
        
        <h2 id="behaviorial_conditioning_algorithm">Behavioral Conditioning Algorithm</h2>
        <section>
            <div class="row">
                <div class="col">
                    <img class="alg_img" src="../images/mapping_setup.png" alt="mapping_setup.png">

                    <img class="alg_img" src="../images/machine_alg.png" alt="machine_alg.png">
                </div>

                <div class="col">
                    <p>Using our proposed testbed, we propose Behavioral Conditioning (BCo): an improved end-to-end controller <b class="bold">specifically designed</b> for high-speed autonomous driving. An LSTM-VAE neural network creates an approximator policy that predicts the desired steering action and motor-speed given an image input. A PID controller is also used to track the desired motor-speed with the observed target motor-speed using throttle action. Our algorithm is specifically designed to address the issue of noisy action outputs (of which is prevalent when directly correlating image inputs to action outputs)</p>

                    <p>First, BCo decouples both the task of low level vehicle control and high level path planning to address noise in throttle action outputs. While existing work attempts to solve the issue of noisy inference output via hardware, a hardware constrained scenario within this open-source platform makes it difficult to achieve. By decoupling the task of high speed autonomous driving using a PID controller, it is possible to directly track desired motor shaft speed as to alleviate and noisy throttle commands when inferencing action commands directly with convolutional neural networks.</p>

                    <p>Second, BCo addresses noisy outputs by using a Variational Auto-Encoder (VAE) architecture to make the neural network output continuous. Continuous action outputs are achieved by using the KL-divergence equation as shown to regularize the latent variables. The latent variables (which consist of gaussians) use the KL-divergence as a regularization term such that their distributions closely match a standard normal distribution â€“ thus encouraging continuity between action outputs when given similar image inputs.</p>
                </div>
            </div>
        </section>

<!--         <section class="gap">
        </section>
        <hr width="95%">
        <section class="gap">
        </section>
 -->
        <h2 id="github">Github Code</h2>
        <secton>
            <p>This <a class="github_link" href="https://github.com/jessecha/MACHInE">Github repository</a> contains all the necessary code needed for the open-source racecar project. The purpose of each folder and what it contains is also documented below.</p>
            <div class="row">
                <div class="col">
                    <h2>1. Data Collection</h2>
                    <p>The â€˜data_collectionâ€™ folder includes six folders for the Robot Operating System (ROS). It also contains the launch file for data collection. One can selectively record specific ROS topics after launching the launch file using the â€˜rosbag recordâ€˜ command. During data collection, it is important to <b class="bold">use the isocpus command</b> to isolate CPU core: 0 within the Raspberry Pi (as to maximize the number of collected frames).</p>
                </div>

                <div class="col">
                    <h2>2. Train</h2>
                    <p>The â€˜trainâ€˜ folder contains the â€˜dataparserâ€˜ folder to <b class="bold">convert rosbag recordings into a csv file format</b>. The â€˜lrcn_motor.pyâ€˜ script is used to train the model. Tensorflow 2.4 was used with Tensorflow lite to convert and quantize the model. There are several models to choose from in the model folder (however, it's worth noting that that the vision transformer model might not be supported with tflite during conversion).</p>
                </div>

                <div class="col">
                    <h2>3. Deploy</h2>
                    <p>The â€˜deployâ€˜ folder contains a script to deploy the tflite model.</p>
                </div>
            </div>

            <div class="row">
                <div class="col">
                     <h2>4. Evaluate</h2>
                    <p>TThe â€˜Evaluateâ€˜ folder contains the following: a ROS folder to record the logitech brio stream and a script called, the â€˜ground_truth_tracker.ipynbâ€˜ which processes the rosbag into a video, and scripts for salient feature representation.</p>
                </div>

                <div class="col">
                    <h2>5. Tools</h2>
                    <p>The â€˜toolsâ€˜ folder contains useful commands. The usb_list.sh command lists all the devices linked to the Raspberry Pi board / desktop via USB port.</p>
                </div>

                <div class="col">
                    <h2>6. STL Files</h2>
                    <p>This folder contains all the necessary STL files needed to print the vehicle mounts. It is important to note that <b class="bold">all the Ethernet ports and USB ports must be stripped prior to assembly.</b> A quality print is necessary for the â€˜t_connector.stlâ€˜ file â€“ as an uneven print will cause the vehicle to warp, resulting in unwanted behavior when trying to drive straight</p>
                </div>
            </div>
        </secton>

        <h2 id="outcome">Outcome</h2>
        <section>
            <p>We have outlined not only the necesssary components and costs needed to build an autonomous radio control car, but have also provided an adequate tutorial in constructing one as well. If you have any questions regarding anything, feel free to reach out and we will gladly help.</p>
            <p class="opcas_link">Check out another project&nbsp;<a href="./opcas.html">@OP-CAS</a></p>
        </section>

         <section class="gap">
        </section>
    </article>
</body>
</html>
